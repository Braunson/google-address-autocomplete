{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["export default class AddressAutocomplete {\n  constructor(element, callback) {\n    this.element = document.querySelector(element);\n\n    if (!this.element) {\n      throw new Error(\n        `The element you specified is not a valid element. You should attach an input using a class '.some-class' or an ID '#some-id'.`\n      );\n    }\n\n    this.callback = callback;\n    this.extractAddress = this.extractAddress.bind(this);\n    this.getUsersLocation = this.getUsersLocation.bind(this);\n    this.handle();\n  }\n\n  // When the document is ready, we need to fire everything off.\n  handle() {\n    document.onreadystatechange = () => {\n      this.init();\n      this.element.addEventListener('focus', this.getUsersLocation);\n    };\n  }\n\n  init(element) {\n    this.autocomplete = new google.maps.places.Autocomplete(this.element, {\n      types: ['geocode'],\n    });\n    this.autocomplete.addListener('place_changed', this.extractAddress);\n  }\n\n  extractAddress() {\n    const componentForm = {\n      street_number: 'short_name',\n      route: 'long_name',\n      locality: 'long_name',\n      administrative_area_level_1: 'short_name',\n      country: 'long_name',\n      postal_code: 'short_name',\n    };\n\n    const {\n      address_components,\n      formatted_address,\n    } = this.autocomplete.getPlace();\n    const addressObject = {\n      streetNumber: '',\n      streetName: '',\n      cityName: '',\n      stateAbbr: '',\n      zipCode: '',\n    };\n\n    for (let i = 0; i < address_components.length; i++) {\n      const addressType = address_components[i].types[0];\n      if (componentForm[addressType]) {\n        switch (addressType) {\n          case 'street_number':\n            addressObject.streetNumber = address_components[i].long_name;\n            break;\n          case 'route':\n            addressObject.streetName = address_components[i].long_name;\n            break;\n          case 'locality':\n            addressObject.cityName = address_components[i].long_name;\n            break;\n          case 'administrative_area_level_1':\n            addressObject.stateAbbr = address_components[i].short_name;\n            addressObject.state = address_components[i].long_name;\n            break;\n          case 'postal_code':\n            addressObject.zipCode = address_components[i].long_name;\n            break;\n          case 'country':\n            addressObject.countryAbbr = address_components[i].short_name;\n            addressObject.country = address_components[i].long_name;\n            break;\n          default:\n            break;\n        }\n      }\n    }\n\n    const result = Object.assign({}, addressObject, {formattedAddress: formatted_address});\n\n    this.callback && this.callback(result);\n  }\n\n  getUsersLocation() {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(position => {\n        const geolocation = {\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        };\n        const circle = new google.maps.Circle({\n          center: geolocation,\n          radius: position.coords.accuracy,\n        });\n        this.autocomplete.setBounds(circle.getBounds());\n      });\n    }\n  }\n}\n"],"names":["AddressAutocomplete","element","callback","document","querySelector","this","Error","extractAddress","bind","getUsersLocation","handle","onreadystatechange","init","addEventListener","_this","autocomplete","google","maps","places","Autocomplete","addListener","componentForm","getPlace","address_components","formatted_address","addressObject","i","length","addressType","types","streetNumber","long_name","streetName","cityName","stateAbbr","short_name","state","zipCode","countryAbbr","country","result","Object","assign","formattedAddress","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","circle","Circle","accuracy","setBounds","getBounds"],"mappings":"6XAAqBA,0CACPC,EAASC,mCACdD,QAAUE,SAASC,cAAcH,IAEjCI,KAAKJ,cACF,IAAIK,4IAKPJ,SAAWA,OACXK,eAAiBF,KAAKE,eAAeC,KAAKH,WAC1CI,iBAAmBJ,KAAKI,iBAAiBD,KAAKH,WAC9CK,mFAKIC,mBAAqB,aACvBC,SACAX,QAAQY,iBAAiB,QAASC,EAAKL,gDAI3CR,QACEc,aAAe,IAAIC,OAAOC,KAAKC,OAAOC,aAAad,KAAKJ,gBACnD,kBAELc,aAAaK,YAAY,gBAAiBf,KAAKE,6DAyB/C,IArBCc,iBACW,mBACR,qBACG,wCACmB,qBACpB,wBACI,gBAMXhB,KAAKU,aAAaO,WAFpBC,IAAAA,mBACAC,IAAAA,kBAEIC,gBACU,cACF,YACF,aACC,WACF,IAGFC,EAAI,EAAGA,EAAIH,EAAmBI,OAAQD,IAAK,KAC5CE,EAAcL,EAAmBG,GAAGG,MAAM,MAC5CR,EAAcO,UACRA,OACD,kBACWE,aAAeP,EAAmBG,GAAGK,oBAEhD,UACWC,WAAaT,EAAmBG,GAAGK,oBAE9C,aACWE,SAAWV,EAAmBG,GAAGK,oBAE5C,gCACWG,UAAYX,EAAmBG,GAAGS,aAClCC,MAAQb,EAAmBG,GAAGK,oBAEzC,gBACWM,QAAUd,EAAmBG,GAAGK,oBAE3C,YACWO,YAAcf,EAAmBG,GAAGS,aACpCI,QAAUhB,EAAmBG,GAAGK,eAQhDS,EAASC,OAAOC,UAAWjB,GAAgBkB,iBAAkBnB,SAE9DtB,UAAYG,KAAKH,SAASsC,yDAI3BI,UAAUC,uBACFA,YAAYC,mBAAmB,gBACjCD,OACCE,EAASC,OAAOC,aAChBF,EAASC,OAAOE,WAEjBC,EAAS,IAAInC,OAAOC,KAAKmC,eACrBP,SACAE,EAASC,OAAOK,aAErBtC,aAAauC,UAAUH,EAAOI"}